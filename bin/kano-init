#!/usr/bin/env python
#
# kano-init
#
# Copyright (C) 2015 Kano Computing Ltd.
# License: http://www.gnu.org/licenses/gpl-2.0.txt GNU GPL v2
#
# Create new users and initialise the OS for them.
#

"""
kano-init can create new users and initialise the OS for them.

Usage:
  kano-init reset
  kano-init user (add|delete)
  kano-init flow [<stage>]

Options:
  -h, --help       Show this message.
  -v, --version    Print the version of the updater.
"""

import os
import sys

import docopt

if __name__ == '__main__' and __package__ is None:
    dir_path = os.path.abspath(os.path.join(os.path.dirname(__file__), '..'))
    if dir_path != '/usr':
        sys.path.insert(0, dir_path)
    else:
        locale_path = None

from kano.utils import enforce_root
from kano.logging import logger

from kano_init.terminal import typewriter_echo
from kano_init.flow import flow

def main():
    msg = 'ERROR: Administrator priviledges are required to ' + \
          'perform this operation'
    enforce_root(msg)

    # TODO: put the version somewhere nicer
    version = 2.0
    args = docopt.docopt(__doc__, version=str(version))

    if args['flow']:
        flow(args['<stage>'])

    return 0

if __name__ == '__main__':
    sys.exit(main())
